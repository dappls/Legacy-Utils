package net.dappls.legacy_utils.Toggles;

import net.dappls.legacy_utils.client.Util.ChatUtils;
import net.fabricmc.api.EnvType;
import net.fabricmc.api.Environment;
import net.fabricmc.fabric.api.client.event.lifecycle.v1.ClientTickEvents;
import net.fabricmc.fabric.api.client.rendering.v1.WorldRenderEvents;
import net.minecraft.client.MinecraftClient;
import net.minecraft.client.render.Camera;
import net.minecraft.client.render.RenderLayer;
import net.minecraft.client.render.VertexConsumer;
import net.minecraft.client.render.VertexConsumerProvider;
import net.minecraft.client.util.math.MatrixStack;
import net.minecraft.util.math.BlockPos;

import java.awt.*;
import java.util.ArrayList;
import java.util.List;

import static net.dappls.legacy_utils.client.Util.TrailRenderer.renderCube;

@Environment(EnvType.CLIENT)
public class WaterParticleTrail {

    private static final int[][] waterPickaxeCoords = {{-12175, 57, 12546}, {-12176, 57, 12546}, {-12176, 56, 12546}, {-12176, 55, 12546}, {-12176, 54, 12546}, {-12176, 53, 12546}, {-12176, 52, 12546}, {-12176, 52, 12545}, {-12176, 51, 12545}, {-12176, 50, 12545}, {-12175, 49, 12545}, {-12175, 48, 12545}, {-12175, 47, 12545}, {-12175, 47, 12546}, {-12175, 46, 12546}, {-12174, 46, 12546}, {-12174, 45, 12546}, {-12174, 44, 12547}, {-12173, 43, 12548}, {-12173, 43, 12549}, {-12173, 42, 12549}, {-12172, 42, 12549}, {-12172, 42, 12550}, {-12172, 41, 12550}, {-12172, 41, 12551}, {-12171, 40, 12551}, {-12171, 40, 12552}, {-12170, 40, 12552}, {-12170, 39, 12552}, {-12170, 39, 12553}, {-12169, 39, 12553}, {-12169, 38, 12553}, {-12169, 38, 12554}, {-12168, 38, 12554}, {-12168, 37, 12555}, {-12167, 37, 12555}, {-12167, 37, 12556}, {-12167, 36, 12556}, {-12166, 36, 12556}, {-12166, 36, 12557}, {-12165, 36, 12557}, {-12165, 35, 12557}, {-12165, 35, 12558}, {-12164, 35, 12558}, {-12164, 35, 12559}, {-12163, 35, 12559}, {-12163, 34, 12559}, {-12162, 34, 12559}, {-12162, 34, 12560}, {-12161, 33, 12560}, {-12160, 33, 12560}, {-12160, 32, 12560}, {-12159, 32, 12560}, {-12159, 32, 12561}, {-12158, 32, 12561}, {-12158, 31, 12561}, {-12157, 31, 12561}, {-12156, 31, 12561}, {-12156, 30, 12561}, {-12155, 30, 12561}, {-12154, 29, 12561}, {-12153, 29, 12561}, {-12153, 28, 12561}, {-12152, 28, 12561}, {-12152, 27, 12561}, {-12151, 27, 12561}, {-12151, 26, 12561}, {-12150, 26, 12561}, {-12150, 26, 12562}, {-12150, 26, 12561}, {-12149, 26, 12561}, {-12149, 27, 12560}, {-12148, 27, 12560}, {-12148, 28, 12560}, {-12147, 28, 12559}, {-12147, 29, 12559}, {-12146, 29, 12559}, {-12146, 30, 12559}, {-12146, 30, 12558}, {-12145, 30, 12558}, {-12145, 31, 12558}, {-12144, 31, 12558}, {-12144, 31, 12557}, {-12144, 32, 12557}, {-12143, 32, 12557}, {-12142, 32, 12557}, {-12142, 33, 12557}, {-12142, 33, 12556}, {-12141, 33, 12556}, {-12141, 34, 12556}, {-12140, 34, 12556}, {-12140, 34, 12555}, {-12139, 34, 12555}, {-12139, 35, 12555}, {-12138, 35, 12555}, {-12137, 35, 12555}, {-12136, 35, 12555}, {-12136, 36, 12555}, {-12135, 36, 12555}, {-12134, 36, 12555}, {-12133, 36, 12555}, {-12133, 37, 12555}, {-12132, 37, 12555}, {-12132, 37, 12556}, {-12131, 37, 12556}, {-12130, 37, 12556}, {-12129, 37, 12556}, {-12128, 37, 12557}, {-12127, 37, 12557}, {-12126, 37, 12557}, {-12126, 37, 12558}, {-12125, 37, 12558}, {-12125, 37, 12559}, {-12124, 37, 12559}, {-12124, 36, 12559}, {-12124, 36, 12560}, {-12123, 36, 12561}, {-12123, 35, 12561}, {-12123, 34, 12562}, {-12122, 34, 12562}, {-12122, 33, 12562}, {-12122, 33, 12563}, {-12122, 32, 12563}, {-12121, 31, 12563}, {-12121, 30, 12563}, {-12121, 30, 12564}, {-12121, 29, 12564}, {-12120, 29, 12564}, {-12120, 29, 12565}, {-12121, 29, 12565}, {-12121, 29, 12566}, {-12121, 30, 12566}, {-12122, 30, 12566}, {-12122, 30, 12567}, {-12121, 30, 12567}, {-12121, 31, 12567}, {-12121, 31, 12568}, {-12120, 31, 12568}, {-12120, 31, 12569}, {-12119, 31, 12569}, {-12118, 31, 12569}, {-12118, 31, 12570}, {-12117, 31, 12570}, {-12116, 31, 12570}, {-12116, 31, 12571}, {-12115, 31, 12571}, {-12115, 32, 12571}, {-12114, 32, 12571}, {-12113, 32, 12571}, {-12112, 32, 12571}, {-12111, 32, 12571}, {-12110, 32, 12571}, {-12109, 32, 12571}, {-12108, 32, 12571}, {-12107, 32, 12571}, {-12106, 32, 12571}, {-12105, 32, 12571}, {-12104, 32, 12571}, {-12103, 32, 12571}, {-12103, 31, 12571}, {-12102, 31, 12571}, {-12101, 31, 12571}, {-12100, 31, 12571}, {-12100, 31, 12570}, {-12099, 31, 12570}, {-12099, 31, 12569}, {-12098, 31, 12569}, {-12097, 31, 12569}, {-12097, 31, 12568}, {-12096, 31, 12568}, {-12096, 32, 12568}, {-12096, 32, 12567}, {-12095, 32, 12567}, {-12095, 33, 12567}, {-12094, 33, 12567}, {-12094, 34, 12566}, {-12093, 35, 12566}, {-12093, 35, 12565}, {-12093, 36, 12565}, {-12092, 36, 12565}, {-12092, 37, 12564}, {-12091, 37, 12563}, {-12091, 38, 12563}, {-12091, 38, 12562}, {-12090, 38, 12562}, {-12090, 38, 12561}, {-12090, 39, 12561}, {-12090, 39, 12560}, {-12090, 39, 12559}, {-12089, 39, 12559}, {-12089, 39, 12558}, {-12089, 39, 12557}, {-12089, 39, 12556}, {-12088, 39, 12556}, {-12088, 39, 12555}, {-12088, 39, 12554}, {-12088, 39, 12553}, {-12088, 39, 12552}, {-12088, 39, 12551}, {-12088, 39, 12550}, {-12088, 39, 12549}, {-12088, 39, 12548}, {-12088, 38, 12548}, {-12088, 38, 12547}, {-12088, 37, 12547}, {-12088, 36, 12546}, {-12088, 35, 12546}, {-12088, 35, 12545}, {-12087, 35, 12545}, {-12087, 34, 12545}, {-12087, 33, 12544}, {-12087, 33, 12543}, {-12087, 32, 12543}, {-12087, 32, 12542}, {-12086, 31, 12542}, {-12086, 30, 12542}, {-12086, 29, 12541}, {-12085, 29, 12541}, {-12085, 28, 12541}, {-12084, 28, 12541}, {-12084, 27, 12541}, {-12083, 26, 12541}, {-12083, 26, 12540}, {-12083, 25, 12540}, {-12082, 25, 12540}, {-12082, 24, 12540}, {-12081, 24, 12540}, {-12081, 23, 12539}, {-12080, 23, 12539}, {-12080, 22, 12539}, {-12079, 22, 12539}, {-12079, 21, 12539}, {-12079, 21, 12538}, {-12078, 21, 12538}, {-12078, 20, 12538}, {-12077, 20, 12538}, {-12077, 19, 12537}, {-12077, 18, 12537}, {-12076, 18, 12537}, {-12076, 18, 12536}, {-12076, 17, 12536}, {-12075, 17, 12536}, {-12075, 16, 12536}, {-12074, 16, 12535}, {-12074, 15, 12535}, {-12073, 14, 12535}, {-12073, 14, 12534}, {-12072, 14, 12534}, {-12073, 14, 12534}, {-12073, 14, 12535}, {-12072, 14, 12535}, {-12072, 14, 12536}, {-12071, 14, 12536}, {-12071, 14, 12537}, {-12070, 14, 12537}, {-12070, 15, 12537}, {-12070, 15, 12538}, {-12069, 15, 12538}, {-12069, 15, 12539}, {-12068, 15, 12539}, {-12068, 15, 12540}, {-12067, 15, 12540}, {-12067, 16, 12540}, {-12067, 16, 12541}, {-12066, 16, 12541}, {-12066, 16, 12542}, {-12066, 16, 12543}, {-12065, 16, 12543}, {-12065, 16, 12544}, {-12065, 17, 12544}, {-12064, 17, 12545}, {-12064, 17, 12546}, {-12063, 17, 12547}, {-12063, 18, 12548}, {-12062, 18, 12548}, {-12062, 18, 12549}, {-12062, 18, 12550}, {-12062, 18, 12551}, {-12061, 18, 12551}, {-12061, 18, 12552}, {-12061, 19, 12552}, {-12061, 19, 12553}, {-12061, 19, 12554}, {-12060, 19, 12554}, {-12060, 19, 12555}, {-12060, 19, 12556}, {-12060, 20, 12556}, {-12060, 20, 12557}, {-12059, 20, 12558}, {-12059, 20, 12559}, {-12059, 21, 12559}, {-12059, 21, 12560}, {-12059, 22, 12560}, {-12058, 22, 12561}, {-12058, 23, 12561}, {-12058, 23, 12562}, {-12058, 24, 12562}, {-12058, 24, 12563}, {-12057, 25, 12564}, {-12057, 25, 12565}, {-12057, 26, 12565}, {-12056, 26, 12565}, {-12056, 26, 12566}, {-12055, 27, 12566}, {-12054, 27, 12566}, {-12054, 28, 12566}, {-12053, 28, 12566}, {-12053, 29, 12566}, {-12053, 29, 12565}, {-12052, 29, 12565}, {-12051, 29, 12565}, {-12051, 30, 12565}, {-12050, 30, 12565}, {-12049, 31, 12565}, {-12049, 31, 12564}, {-12049, 32, 12564}, {-12049, 32, 12563}, {-12049, 33, 12563}, {-12049, 33, 12562}, {-12050, 33, 12562}, {-12050, 33, 12563}, {-12050, 33, 12564}, {-12050, 32, 12564}, {-12050, 31, 12564}, {-12051, 31, 12564}, {-12051, 32, 12564}, {-12051, 32, 12563}, {-12051, 33, 12563}, {-12051, 34, 12563}, {-12051, 35, 12563}, {-12051, 36, 12563}, {-12051, 35, 12563}, {-12051, 36, 12563}};
    private static final int[][] waterBossCoords = {{-12053, 30, 12571}, {-12053, 30, 12570}, {-12053, 29, 12570}, {-12054, 29, 12570}, {-12054, 29, 12569}, {-12054, 28, 12569}, {-12055, 28, 12568}, {-12055, 27, 12568}, {-12056, 26, 12567}, {-12056, 26, 12566}, {-12056, 25, 12566}, {-12057, 25, 12566}, {-12057, 25, 12565}, {-12057, 24, 12565}, {-12057, 24, 12564}, {-12057, 24, 12563}, {-12057, 23, 12563}, {-12058, 23, 12563}, {-12058, 23, 12562}, {-12058, 22, 12562}, {-12058, 22, 12561}, {-12058, 22, 12560}, {-12058, 21, 12560}, {-12058, 21, 12559}, {-12059, 21, 12559}, {-12059, 20, 12558}, {-12059, 20, 12557}, {-12059, 19, 12557}, {-12059, 19, 12556}, {-12060, 19, 12556}, {-12060, 19, 12555}, {-12060, 18, 12555}, {-12060, 18, 12554}, {-12061, 18, 12553}, {-12061, 17, 12552}, {-12061, 17, 12551}, {-12062, 17, 12551}, {-12062, 17, 12550}, {-12062, 17, 12549}, {-12063, 17, 12549}, {-12063, 17, 12548}, {-12063, 17, 12547}, {-12064, 17, 12547}, {-12064, 17, 12546}, {-12064, 17, 12545}, {-12065, 17, 12544}, {-12065, 16, 12544}, {-12065, 16, 12543}, {-12066, 16, 12543}, {-12066, 16, 12542}, {-12066, 16, 12541}, {-12067, 16, 12541}, {-12067, 16, 12540}, {-12068, 16, 12539}, {-12068, 16, 12538}, {-12069, 16, 12538}, {-12070, 16, 12538}, {-12070, 16, 12537}, {-12071, 16, 12537}, {-12071, 16, 12536}, {-12072, 16, 12536}, {-12072, 15, 12536}, {-12072, 14, 12535}, {-12073, 14, 12535}, {-12074, 14, 12535}, {-12074, 15, 12535}, {-12074, 16, 12535}, {-12075, 16, 12535}, {-12075, 17, 12535}, {-12076, 17, 12535}, {-12076, 18, 12536}, {-12077, 18, 12536}, {-12077, 19, 12536}, {-12078, 19, 12536}, {-12078, 20, 12536}, {-12079, 20, 12536}, {-12079, 21, 12536}, {-12080, 21, 12536}, {-12080, 22, 12536}, {-12081, 22, 12536}, {-12082, 22, 12536}, {-12082, 23, 12536}, {-12083, 23, 12536}, {-12083, 24, 12536}, {-12084, 24, 12536}, {-12084, 25, 12536}, {-12084, 25, 12535}, {-12085, 25, 12535}, {-12085, 26, 12535}, {-12086, 26, 12535}, {-12086, 26, 12534}, {-12086, 27, 12534}, {-12087, 27, 12534}, {-12087, 27, 12533}, {-12087, 28, 12533}, {-12088, 28, 12533}, {-12088, 28, 12532}, {-12089, 28, 12532}, {-12089, 28, 12531}, {-12090, 28, 12531}, {-12090, 28, 12530}, {-12090, 29, 12530}, {-12090, 29, 12529}, {-12091, 30, 12529}, {-12091, 30, 12528}, {-12091, 31, 12528}, {-12091, 31, 12527}, {-12091, 32, 12527}, {-12092, 32, 12527}, {-12092, 33, 12526}, {-12092, 34, 12525}, {-12092, 35, 12525}, {-12093, 35, 12525}, {-12093, 35, 12524}, {-12093, 35, 12523}, {-12093, 35, 12522}, {-12093, 35, 12521}, {-12094, 35, 12521}, {-12094, 35, 12520}, {-12094, 35, 12519}, {-12094, 35, 12518}, {-12094, 34, 12517}, {-12094, 34, 12516}, {-12095, 34, 12516}, {-12095, 34, 12515}, {-12095, 33, 12515}, {-12095, 33, 12514}, {-12095, 33, 12513}, {-12095, 32, 12513}, {-12095, 32, 12512}, {-12096, 32, 12512}, {-12096, 32, 12511}, {-12096, 32, 12510}, {-12096, 31, 12510}, {-12096, 31, 12509}, {-12097, 31, 12509}, {-12097, 31, 12508}, {-12097, 30, 12507}, {-12097, 30, 12506}, {-12098, 30, 12506}, {-12098, 30, 12505}, {-12098, 30, 12504}, {-12098, 29, 12504}, {-12099, 29, 12504}, {-12099, 29, 12503}, {-12099, 29, 12502}, {-12100, 29, 12502}, {-12100, 28, 12501}, {-12101, 28, 12501}, {-12101, 28, 12500}, {-12102, 28, 12500}, {-12102, 27, 12500}, {-12102, 27, 12499}, {-12103, 27, 12499}, {-12104, 27, 12499}, {-12104, 27, 12498}, {-12105, 27, 12498}, {-12106, 27, 12498}, {-12107, 27, 12498}, {-12107, 27, 12497}, {-12107, 26, 12497}, {-12108, 26, 12497}, {-12109, 26, 12497}, {-12109, 26, 12496}, {-12110, 26, 12496}, {-12111, 26, 12496}, {-12111, 26, 12495}, {-12112, 26, 12495}, {-12113, 26, 12495}, {-12113, 26, 12494}, {-12113, 25, 12494}, {-12114, 25, 12494}, {-12114, 25, 12493}, {-12115, 25, 12493}, {-12116, 25, 12493}, {-12116, 25, 12492}, {-12117, 25, 12492}, {-12117, 25, 12491}, {-12118, 25, 12491}, {-12118, 25, 12490}, {-12119, 25, 12490}, {-12119, 25, 12489}, {-12120, 25, 12489}, {-12120, 25, 12488}, {-12121, 25, 12488}, {-12121, 25, 12487}, {-12122, 25, 12487}, {-12122, 25, 12486}, {-12123, 25, 12486}, {-12123, 25, 12485}, {-12124, 25, 12485}, {-12124, 25, 12484}, {-12125, 25, 12483}, {-12125, 24, 12483}, {-12126, 24, 12482}, {-12126, 24, 12481}, {-12127, 24, 12481}, {-12127, 24, 12480}, {-12128, 24, 12480}, {-12128, 24, 12479}, {-12129, 24, 12479}, {-12129, 24, 12478}, {-12130, 24, 12478}, {-12130, 23, 12478}, {-12131, 23, 12477}, {-12131, 22, 12477}, {-12131, 21, 12476}, {-12132, 21, 12476}, {-12131, 21, 12476}, {-12130, 21, 12476}, {-12130, 22, 12476}, {-12130, 23, 12476}, {-12129, 23, 12476}, {-12129, 24, 12476}, {-12129, 25, 12476}, {-12129, 25, 12475}, {-12129, 26, 12475}, {-12128, 26, 12475}, {-12128, 27, 12475}, {-12128, 27, 12474}, {-12128, 28, 12474}, {-12128, 29, 12474}, {-12128, 30, 12473}, {-12128, 31, 12473}, {-12128, 31, 12472}, {-12128, 32, 12472}, {-12128, 33, 12472}, {-12128, 34, 12471}, {-12128, 35, 12471}, {-12128, 36, 12471}, {-12127, 36, 12471}, {-12127, 36, 12470}, {-12127, 37, 12470}, {-12127, 38, 12470}, {-12126, 39, 12470}, {-12126, 40, 12470}, {-12125, 41, 12470}, {-12125, 42, 12470}, {-12125, 43, 12470}, {-12124, 43, 12470}, {-12124, 44, 12470}, {-12123, 45, 12470}, {-12122, 45, 12470}, {-12122, 46, 12470}, {-12121, 46, 12470}, {-12120, 46, 12470}, {-12120, 46, 12471}, {-12119, 46, 12471}, {-12119, 46, 12472}, {-12118, 46, 12472}, {-12118, 45, 12473}, {-12117, 45, 12473}, {-12117, 45, 12474}, {-12116, 45, 12474}, {-12115, 45, 12475}, {-12114, 45, 12476}, {-12113, 45, 12476}, {-12113, 45, 12477}, {-12112, 45, 12477}, {-12112, 45, 12478}, {-12111, 45, 12478}, {-12111, 45, 12479}, {-12110, 45, 12479}, {-12110, 45, 12480}, {-12109, 45, 12480}, {-12109, 45, 12481}, {-12108, 45, 12481}, {-12108, 44, 12481}, {-12108, 44, 12482}, {-12107, 44, 12482}, {-12107, 44, 12483}, {-12106, 44, 12483}, {-12106, 43, 12483}, {-12106, 43, 12484}, {-12106, 42, 12484}, {-12105, 42, 12484}, {-12105, 41, 12484}, {-12105, 41, 12485}, {-12104, 40, 12485}, {-12103, 40, 12486}, {-12102, 41, 12486}, {-12102, 41, 12487}, {-12101, 41, 12487}, {-12100, 41, 12487}, {-12099, 41, 12487}, {-12099, 41, 12488}, {-12099, 40, 12488}, {-12098, 40, 12488}, {-12097, 40, 12488}, {-12096, 40, 12488}, {-12096, 40, 12489}, {-12095, 40, 12489}, {-12094, 40, 12489}, {-12093, 40, 12489}, {-12092, 40, 12489}, {-12091, 40, 12489}, {-12091, 39, 12489}, {-12090, 39, 12489}, {-12089, 39, 12489}, {-12088, 39, 12489}, {-12087, 39, 12489}, {-12087, 39, 12488}, {-12087, 39, 12487}, {-12087, 39, 12486}, {-12087, 39, 12485}, {-12087, 38, 12485}, {-12087, 38, 12484}, {-12087, 38, 12483}, {-12087, 38, 12482}, {-12087, 37, 12481}, {-12087, 37, 12480}, {-12086, 37, 12480}, {-12086, 37, 12479}, {-12086, 37, 12478}, {-12086, 37, 12477}, {-12085, 37, 12477}, {-12084, 37, 12477}, {-12084, 37, 12476}, {-12083, 37, 12476}, {-12082, 37, 12476}, {-12081, 38, 12476}, {-12080, 38, 12476}, {-12079, 38, 12476}, {-12078, 38, 12476}, {-12077, 38, 12476}, {-12076, 38, 12476}, {-12075, 38, 12476}, {-12074, 38, 12476}, {-12073, 38, 12476}, {-12072, 38, 12476}, {-12071, 38, 12476}, {-12070, 38, 12476}, {-12069, 38, 12476}, {-12069, 37, 12476}} ;
    private static final int[][] waterConduitCoords = {{-12047, 50, 12476}, {-12047, 50, 12477}, {-12047, 50, 12478}, {-12047, 51, 12478}, {-12047, 51, 12479}, {-12047, 51, 12480}, {-12047, 51, 12481}, {-12047, 52, 12481}, {-12047, 52, 12482}, {-12047, 52, 12483}, {-12047, 52, 12484}, {-12047, 52, 12485}, {-12047, 53, 12485}, {-12047, 53, 12486}, {-12047, 53, 12487}, {-12047, 53, 12488}, {-12047, 53, 12489}, {-12047, 53, 12490}, {-12047, 53, 12491}, {-12047, 53, 12492}, {-12047, 53, 12493}, {-12047, 53, 12494}, {-12047, 53, 12495}, {-12047, 53, 12496}, {-12047, 53, 12497}, {-12047, 53, 12498}, {-12047, 53, 12499}, {-12046, 53, 12499}, {-12046, 53, 12500}, {-12047, 53, 12500}, {-12047, 53, 12501}, {-12047, 52, 12501}, {-12048, 52, 12501}, {-12048, 52, 12500}, {-12049, 52, 12500}, {-12049, 52, 12499}, {-12049, 52, 12498}, {-12049, 52, 12497}, {-12048, 52, 12497}, {-12048, 52, 12496}, {-12048, 52, 12495}, {-12048, 52, 12494}, {-12048, 52, 12493}, {-12048, 53, 12492}, {-12048, 53, 12491}, {-12048, 53, 12490}, {-12048, 53, 12489}, {-12048, 53, 12488}, {-12048, 53, 12487}, {-12048, 53, 12486}, {-12048, 53, 12485}, {-12048, 53, 12484}, {-12049, 53, 12484}, {-12049, 53, 12483}, {-12049, 53, 12482}, {-12050, 53, 12482}, {-12050, 53, 12481}, {-12051, 53, 12481}, {-12051, 53, 12480}, {-12052, 53, 12480}, {-12052, 53, 12479}, {-12052, 54, 12479}, {-12053, 54, 12479}, {-12054, 54, 12478}, {-12055, 54, 12478}, {-12056, 54, 12478}, {-12056, 54, 12477}, {-12057, 54, 12477}, {-12058, 54, 12477}, {-12058, 53, 12477}, {-12059, 53, 12477}, {-12060, 53, 12477}, {-12061, 53, 12477}, {-12062, 53, 12477}, {-12062, 53, 12478}, {-12063, 53, 12478}, {-12063, 53, 12479}, {-12063, 53, 12480}, {-12063, 53, 12481}, {-12063, 53, 12482}, {-12063, 54, 12482}, {-12063, 54, 12483}, {-12063, 54, 12484}, {-12063, 53, 12485}, {-12064, 52, 12485}, {-12064, 52, 12486}, {-12064, 51, 12486}, {-12065, 51, 12486}, {-12066, 52, 12486}, {-12067, 53, 12486}, {-12068, 53, 12486}, {-12068, 53, 12487}, {-12069, 53, 12487}, {-12070, 53, 12487}, {-12071, 53, 12487}, {-12072, 53, 12487}, {-12072, 53, 12486}, {-12072, 53, 12487}, {-12073, 53, 12487}, {-12074, 54, 12487}, {-12074, 54, 12486}, {-12075, 54, 12486}, {-12076, 54, 12486}, {-12077, 54, 12486}, {-12078, 54, 12486}, {-12079, 54, 12486}, {-12080, 54, 12486}, {-12081, 54, 12486}, {-12081, 54, 12485}, {-12082, 54, 12485}, {-12082, 54, 12484}, {-12082, 54, 12483}, {-12082, 54, 12482}, {-12082, 54, 12481}, {-12082, 54, 12480}, {-12082, 54, 12479}, {-12082, 54, 12478}, {-12081, 54, 12477}, {-12080, 54, 12476}, {-12080, 53, 12476}, {-12079, 53, 12476}, {-12078, 53, 12476}, {-12077, 53, 12476}, {-12077, 53, 12475}, {-12076, 53, 12475}, {-12075, 53, 12475}, {-12074, 53, 12475}, {-12073, 53, 12475}, {-12073, 53, 12476}, {-12072, 53, 12476}, {-12072, 53, 12477}, {-12073, 53, 12477}, {-12074, 53, 12477}, {-12075, 53, 12477}, {-12076, 53, 12477}, {-12077, 53, 12477}, {-12078, 53, 12477}, {-12079, 53, 12477}, {-12080, 53, 12477}, {-12080, 53, 12478}, {-12081, 53, 12478}, {-12081, 53, 12479}, {-12081, 53, 12480}, {-12081, 53, 12481}, {-12081, 53, 12482}, {-12081, 53, 12483}, {-12080, 53, 12483}, {-12080, 53, 12484}, {-12080, 53, 12485}, {-12079, 53, 12485}, {-12078, 53, 12485}, {-12077, 53, 12485}, {-12076, 53, 12485}, {-12075, 53, 12485}, {-12074, 53, 12485}, {-12073, 53, 12485}, {-12072, 53, 12485}, {-12071, 53, 12485}, {-12070, 53, 12485}, {-12069, 53, 12485}, {-12068, 53, 12485}, {-12067, 53, 12485}, {-12067, 54, 12485}, {-12066, 54, 12485}, {-12065, 54, 12485}, {-12065, 54, 12484}, {-12064, 54, 12484}, {-12064, 54, 12483}, {-12064, 54, 12482}, {-12064, 54, 12481}, {-12064, 54, 12480}, {-12064, 54, 12479}, {-12064, 54, 12478}, {-12064, 54, 12477}, {-12064, 54, 12476}, {-12063, 54, 12476}, {-12062, 54, 12476}, {-12061, 54, 12475}, {-12060, 54, 12475}, {-12059, 54, 12475}, {-12058, 53, 12475}, {-12057, 53, 12475}, {-12056, 53, 12475}, {-12055, 53, 12475}, {-12054, 53, 12475}, {-12054, 53, 12474}, {-12053, 53, 12474}, {-12053, 53, 12473}, {-12052, 53, 12473}, {-12052, 54, 12472}, {-12051, 54, 12472}, {-12051, 54, 12471}, {-12050, 54, 12471}, {-12049, 54, 12471}, {-12049, 54, 12470}, {-12049, 54, 12469}, {-12048, 54, 12469}, {-12048, 54, 12468}, {-12048, 54, 12467}, {-12048, 54, 12466}, {-12048, 54, 12465}, {-12048, 54, 12464}, {-12048, 54, 12463}, {-12048, 54, 12462}, {-12048, 54, 12461}, {-12048, 54, 12460}, {-12048, 54, 12459}, {-12048, 54, 12458}, {-12048, 54, 12457}, {-12048, 54, 12456}, {-12048, 54, 12455}, {-12048, 53, 12455}, {-12048, 54, 12454}, {-12048, 54, 12453}, {-12048, 54, 12452}, {-12048, 54, 12451}, {-12048, 53, 12451}, {-12047, 53, 12451}, {-12047, 53, 12452}, {-12047, 54, 12452}, {-12047, 54, 12453}, {-12046, 54, 12453}, {-12046, 54, 12454}, {-12046, 53, 12454}, {-12047, 54, 12455}, {-12047, 54, 12456}, {-12047, 53, 12456}, {-12047, 53, 12457}, {-12047, 53, 12458}, {-12047, 53, 12459}, {-12046, 53, 12459}, {-12046, 53, 12460}, {-12045, 53, 12460}, {-12044, 53, 12460}, {-12043, 53, 12460}, {-12042, 53, 12460}, {-12041, 53, 12460}, {-12041, 53, 12459}, {-12040, 53, 12459}, {-12039, 53, 12460}, {-12038, 53, 12460}, {-12037, 53, 12460}, {-12036, 53, 12460}, {-12035, 53, 12460}, {-12034, 53, 12460}, {-12033, 53, 12460}, {-12032, 53, 12460}, {-12031, 53, 12460}, {-12031, 53, 12461}, {-12030, 53, 12461}, {-12030, 53, 12462}, {-12030, 53, 12463}, {-12030, 53, 12464}, {-12030, 53, 12465}, {-12031, 53, 12465}, {-12031, 53, 12466}, {-12031, 54, 12466}, {-12030, 54, 12466}, {-12030, 54, 12467}, {-12029, 54, 12467}, {-12028, 54, 12467}, {-12027, 54, 12467}, {-12026, 54, 12467}, {-12025, 54, 12467}, {-12024, 54, 12467}, {-12023, 54, 12467}, {-12022, 54, 12467}, {-12021, 54, 12467}, {-12020, 54, 12467}, {-12019, 54, 12467}, {-12018, 54, 12467}, {-12017, 54, 12467}, {-12016, 54, 12467}, {-12015, 54, 12467}, {-12014, 54, 12467}, {-12013, 54, 12467}, {-12012, 54, 12467}, {-12012, 54, 12468}, {-12013, 54, 12468}, {-12013, 54, 12469}, {-12013, 54, 12470}, {-12013, 54, 12471}, {-12013, 54, 12472}, {-12013, 54, 12473}, {-12013, 54, 12474}, {-12013, 54, 12475}, {-12013, 54, 12476}, {-12013, 54, 12477}, {-12014, 54, 12477}, {-12015, 54, 12477}, {-12016, 54, 12477}, {-12017, 54, 12477}, {-12018, 54, 12477}, {-12019, 54, 12477}, {-12020, 54, 12477}, {-12021, 54, 12477}, {-12021, 54, 12478}, {-12021, 54, 12477}, {-12022, 54, 12477}, {-12023, 54, 12477}};
    public enum WaterTrailMode {
        OFF, PICKAXE, BOSS, CONDUIT;
        public WaterTrailMode next() {
            return values()[(this.ordinal() + 1) % values().length];
        }
    }

    private static WaterTrailMode currentMode = WaterTrailMode.OFF;
    private static final List<BlockPos> activeTrail = new ArrayList<>();

    private static final List<BlockPos> pickaxePath = new ArrayList<>();
    private static final List<BlockPos> bossPath = new ArrayList<>();
    private static final List<BlockPos> conduitPath = new ArrayList<>();


    static {
        for (int[] c : waterPickaxeCoords) pickaxePath.add(new BlockPos(c[0], c[1], c[2]));
        for (int[] c : waterBossCoords) bossPath.add(new BlockPos(c[0], c[1], c[2]));
        for (int[] c : waterConduitCoords) conduitPath.add(new BlockPos(c[0], c[1], c[2]));
    }

    public static WaterTrailMode getCurrentMode() { return currentMode; }

    public static void cycleMode() {
        if (MinecraftClient.getInstance().world != null &&
                MinecraftClient.getInstance().world.isPlayerInRange(-12123, 29, 12569, 1000)) {
            currentMode = currentMode.next();
            switchActiveTrail();
        } else {
            MinecraftClient.getInstance().setScreen(null);
            ChatUtils.sendClientMessage("You are not within range of the puzzle!");
        }
    }

    private static void switchActiveTrail() {
        activeTrail.clear();
        switch (currentMode) {
            case PICKAXE -> activeTrail.addAll(pickaxePath);
            case BOSS -> activeTrail.addAll(bossPath);
            case CONDUIT -> activeTrail.addAll(conduitPath);
        }
    }

    public static void registerTrailListener() {
        ClientTickEvents.END_CLIENT_TICK.register(client -> {
            if (client.world == null || currentMode == WaterTrailMode.OFF) {
                activeTrail.clear();
                return;
            }
            removeNearestTrailBlock();
        });
    }

    public static void register() {
        WorldRenderEvents.AFTER_ENTITIES.register(context -> {
            MatrixStack matrices = context.matrixStack();
            Camera camera = context.camera();
            VertexConsumerProvider consumers = context.consumers();
            if (consumers == null || activeTrail.isEmpty()) return;

            VertexConsumer buffer = consumers.getBuffer(RenderLayer.getDebugQuads());
            int total = activeTrail.size();

            for (int i = 0; i < total; i++) {
                BlockPos pos = activeTrail.get(i);
                float hue = (float) i / total;
                Color color = Color.getHSBColor(hue, 1f, 1f);

                renderCube(
                        matrices, buffer, camera, pos,
                        color.getRed() / 255f,
                        color.getGreen() / 255f,
                        color.getBlue() / 255f
                );
            }
        });
    }

    public static void removeNearestTrailBlock() {
        if (MinecraftClient.getInstance().player == null || activeTrail.isEmpty()) return;

        BlockPos playerPos = MinecraftClient.getInstance().player.getBlockPos();

        int touchedIndex = -1;
        for (int i = 0; i < activeTrail.size(); i++) {
            BlockPos pos = activeTrail.get(i);
            if (playerPos.isWithinDistance(pos,1.0)) {
                touchedIndex = i;
                break;
            }
        }

        if (touchedIndex >= 0) {
            activeTrail.subList(0, touchedIndex + 1).clear();
        }
    }
}


