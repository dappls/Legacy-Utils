package net.dappls.legacy_utils.Toggles;

import net.fabricmc.api.EnvType;
import net.fabricmc.api.Environment;
import net.fabricmc.fabric.api.client.event.lifecycle.v1.ClientTickEvents;
import net.minecraft.client.MinecraftClient;
import net.minecraft.particle.DustParticleEffect;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Vec3d;

import java.util.ArrayList;
import java.util.List;

@Environment(EnvType.CLIENT)
public class DungeonParticleTrail {
    public enum TrailMode {
        OFF,
        LAMPS1AND2,
        LAMP3,
        WINDCHARGE;

        public TrailMode next() {
            return values()[(this.ordinal() + 1) % values().length];
        }
    }

    private static TrailMode currentMode = TrailMode.OFF;
    private static final List<BlockPos> Lamps1and2Path = new ArrayList<>();
    private static final List<BlockPos> Lamp3Path = new ArrayList<>();
    private static final List<BlockPos> WindChargePath = new ArrayList<>();

    private static final int[][] Lamps1and2Coords = {{10039, 152, 50550}, {10037, 152, 50550}, {10038, 152, 50550}, {10036, 151, 50550}, {10025, 151, 50531}, {10035, 150, 50550}, {10035, 150, 50551}, {10024, 151, 50531}, {10034, 148, 50538}, {10036, 150, 50550}, {10034, 148, 50539}, {10034, 149, 50539}, {10024, 150, 50531}, {10031, 147, 50535}, {10032, 146, 50535}, {10032, 147, 50537}, {10030, 148, 50534}, {10032, 147, 50538}, {10033, 147, 50538}, {10023, 150, 50531}, {10032, 147, 50535}, {10032, 146, 50536}, {10032, 147, 50536}, {10033, 148, 50538}, {10032, 146, 50538}, {10030, 148, 50533}, {10039, 149, 50544}, {10028, 149, 50522}, {10031, 148, 50534}, {10031, 147, 50538}, {10031, 146, 50538}, {10039, 148, 50544}, {10029, 148, 50522}, {10031, 147, 50537}, {10039, 149, 50545}, {10035, 148, 50541}, {10026, 149, 50522}, {10025, 149, 50525}, {10037, 148, 50542}, {10027, 149, 50522}, {10025, 149, 50526}, {10025, 149, 50527}, {10026, 149, 50527}, {10040, 151, 50551}, {10040, 151, 50550}, {10036, 148, 50541}, {10036, 148, 50542}, {10030, 147, 50524}, {10026, 151, 50531}, {10022, 143, 50526}, {10026, 151, 50532}, {10020, 143, 50523}, {10030, 145, 50526}, {10020, 143, 50524}, {10030, 145, 50527}, {10020, 143, 50522}, {10030, 145, 50525}, {10028, 148, 50532}, {10029, 148, 50533}, {10029, 148, 50532}, {10027, 147, 50533}, {10040, 150, 50547}, {10041, 150, 50549}, {10040, 150, 50548}, {10019, 137, 50532}, {10028, 147, 50533}, {10028, 147, 50532}, {10040, 150, 50546}, {10023, 147, 50533}, {10024, 147, 50534}, {10023, 147, 50534}, {10023, 143, 50526}, {10022, 146, 50535}, {10021, 146, 50535}, {10022, 146, 50534}, {10021, 146, 50536}, {10021, 146, 50537}, {10023, 146, 50534}, {10041, 151, 50551}, {10034, 149, 50540}, {10035, 149, 50541}, {10020, 142, 50519}, {10035, 149, 50540}, {10038, 149, 50544}, {10038, 149, 50543}, {10037, 149, 50542}, {10030, 148, 50523}, {10020, 139, 50527}, {10030, 148, 50522}, {10026, 150, 50532}, {10020, 142, 50521}, {10028, 150, 50531}, {10020, 142, 50520}, {10028, 150, 50530}, {10019, 138, 50531}, {10019, 138, 50530}, {10027, 150, 50532}, {10020, 139, 50528}, {10029, 147, 50533}, {10020, 139, 50529}, {10040, 150, 50549}, {10028, 150, 50532}, {10029, 147, 50532}, {10020, 139, 50530}, {10016, 140, 50522}, {10015, 140, 50521}, {10015, 141, 50521}, {10017, 140, 50522}, {10015, 140, 50522}, {10017, 140, 50523}, {10019, 140, 50524}, {10016, 140, 50523}, {10018, 140, 50522}, {10019, 143, 50522}, {10019, 139, 50525}, {10019, 143, 50521}, {10018, 140, 50524}, {10018, 140, 50523}, {10019, 139, 50526}, {10019, 139, 50527}, {10015, 141, 50520}, {10015, 141, 50519}, {10019, 139, 50530}, {10017, 141, 50519}, {10016, 141, 50518}, {10019, 136, 50532}, {10026, 148, 50533}, {10019, 136, 50533}, {10026, 148, 50534}, {10027, 148, 50533}, {10023, 148, 50533}, {10023, 149, 50531}, {10023, 149, 50532}, {10027, 149, 50532}, {10025, 148, 50534}, {10024, 144, 50527}, {10024, 144, 50526}, {10025, 144, 50527}, {10023, 145, 50538}, {10022, 145, 50538}, {10022, 145, 50539}, {10026, 144, 50527}, {10026, 144, 50526}, {10029, 145, 50527}, {10026, 148, 50528}, {10021, 145, 50538}, {10027, 144, 50526}, {10027, 145, 50526}, {10029, 145, 50526}, {10026, 148, 50529}, {10021, 145, 50537}, {10027, 148, 50528}, {10027, 149, 50528}, {10028, 145, 50526}, {10027, 148, 50529}, {10026, 148, 50522}, {10028, 149, 50529}, {10026, 148, 50527}, {10025, 148, 50525}, {10025, 148, 50524}, {10025, 148, 50523}, {10024, 148, 50523}, {10023, 145, 50539}, {10025, 148, 50522}, {10024, 148, 50524}, {10018, 142, 50519}, {10040, 149, 50548}, {10017, 142, 50519}, {10019, 142, 50519}, {10023, 144, 50526}, {10030, 146, 50524}, {10040, 149, 50544}, {10040, 149, 50545}, {10018, 136, 50537}, {10020, 144, 50524}, {10021, 144, 50525}, {10021, 144, 50526}, {10030, 146, 50525}, {10028, 149, 50532}, {10019, 136, 50536}, {10039, 151, 50551}, {10019, 136, 50534}, {10019, 136, 50535}};
    private static final int[][] Lamp3Coords ={{10016, 154, 50510}, {10015, 154, 50510}, {10023, 149, 50510}, {10014, 154, 50510}, {10013, 153, 50510}, {10023, 148, 50509}, {10012, 153, 50511}, {10016, 154, 50509}, {10016, 155, 50509}, {10011, 153, 50511}, {10016, 156, 50508}, {10016, 155, 50508}, {10010, 152, 50511}, {10016, 157, 50507}, {10016, 156, 50507}, {10010, 150, 50518}, {10010, 150, 50517}, {10010, 152, 50517}, {10010, 152, 50516}, {10017, 156, 50508}, {10010, 152, 50515}, {10017, 156, 50507}, {10023, 150, 50511}, {10011, 150, 50517}, {10023, 148, 50508}, {10024, 150, 50511}, {10024, 150, 50510}, {10027, 150, 50510}, {10028, 149, 50510}, {10017, 154, 50510}, {10028, 150, 50510}, {10029, 147, 50510}, {10018, 137, 50532}, {10018, 137, 50531}, {10022, 153, 50508}, {10022, 152, 50508}, {10010, 147, 50514}, {10010, 147, 50515}, {10010, 148, 50515}, {10011, 148, 50515}, {10010, 151, 50518}, {10010, 151, 50519}, {10009, 143, 50522}, {10010, 151, 50514}, {10010, 151, 50515}, {10023, 149, 50508}, {10023, 149, 50509}, {10011, 151, 50519}, {10020, 139, 50527}, {10020, 156, 50508}, {10019, 138, 50531}, {10019, 138, 50530}, {10020, 139, 50528}, {10007, 146, 50515}, {10020, 139, 50529}, {10007, 146, 50514}, {10007, 146, 50513}, {10008, 146, 50513}, {10008, 146, 50514}, {10009, 147, 50514}, {10020, 139, 50530}, {10013, 141, 50523}, {10014, 141, 50523}, {10016, 140, 50522}, {10017, 140, 50522}, {10015, 140, 50522}, {10015, 140, 50523}, {10019, 140, 50525}, {10019, 139, 50525}, {10018, 140, 50524}, {10018, 140, 50523}, {10007, 145, 50520}, {10008, 144, 50521}, {10019, 139, 50526}, {10019, 139, 50527}, {10009, 142, 50522}, {10020, 157, 50508}, {10007, 145, 50519}, {10012, 141, 50523}, {10007, 145, 50517}, {10007, 145, 50518}, {10019, 139, 50530}, {10011, 141, 50523}, {10007, 145, 50516}, {10010, 141, 50522}, {10009, 152, 50512}, {10009, 152, 50511}, {10018, 136, 50534}, {10023, 150, 50508}, {10018, 136, 50533}, {10021, 154, 50508}, {10022, 151, 50508}, {10009, 152, 50513}, {10021, 155, 50508}, {10009, 151, 50514}, {10023, 150, 50510}, {10011, 149, 50516}, {10011, 149, 50517}, {10007, 144, 50522}, {10007, 144, 50521}, {10019, 157, 50508}, {10018, 157, 50508}, {10017, 157, 50508}, {10017, 157, 50507}, {10025, 151, 50510}, {10026, 151, 50510}, {10010, 142, 50522}, {10018, 136, 50537}, {10018, 136, 50536}, {10018, 136, 50535}, {10027, 151, 50510}, {10029, 148, 50510}};
    private static final int[][] WindChargeCoords = {{10021, 155, 50521}, {10022, 155, 50523}, {10021, 155, 50522}, {10021, 155, 50523}, {10021, 155, 50520},{10014, 165, 50530}, {10019, 161, 50530}, {10019, 165, 50538}, {10015, 165, 50530}, {10016, 154, 50510}, {10019, 161, 50531}, {10015, 165, 50531}, {10017, 165, 50532}, {10018, 165, 50533}, {10019, 154, 50511}, {10017, 161, 50534}, {10015, 154, 50510}, {10019, 156, 50510}, {10018, 161, 50531}, {10014, 154, 50510}, {10017, 163, 50539}, {10017, 154, 50509}, {10016, 156, 50508}, {10013, 165, 50525}, {10013, 165, 50526}, {10013, 165, 50527}, {10016, 156, 50507}, {10013, 165, 50528}, {10010, 152, 50510}, {10014, 165, 50529}, {10015, 165, 50523}, {10018, 158, 50508}, {10018, 158, 50509}, {10025, 156, 50523}, {10014, 165, 50523}, {10013, 165, 50522}, {10017, 158, 50508}, {10013, 165, 50523}, {10010, 152, 50515}, {10025, 158, 50524}, {10011, 152, 50516}, {10023, 156, 50523}, {10011, 152, 50517}, {10022, 152, 50515}, {10024, 156, 50523}, {10022, 154, 50517}, {10011, 150, 50517}, {10024, 156, 50522}, {10017, 154, 50510}, {10018, 137, 50532}, {10019, 137, 50532}, {10035, 162, 50510}, {10020, 161, 50527}, {10020, 161, 50528}, {10034, 162, 50510}, {10022, 161, 50523}, {10021, 161, 50529}, {10021, 161, 50528}, {10010, 147, 50514}, {10024, 161, 50525}, {10020, 165, 50537}, {10020, 165, 50536}, {10031, 162, 50510}, {10020, 161, 50530}, {10010, 147, 50515}, {10024, 161, 50523}, {10024, 161, 50524}, {10030, 162, 50511}, {10030, 162, 50510}, {10032, 162, 50519}, {10019, 163, 50520}, {10033, 162, 50520}, {10035, 162, 50518}, {10036, 162, 50518}, {10013, 163, 50537}, {10032, 162, 50520}, {10016, 163, 50539}, {10016, 163, 50538}, {10036, 162, 50510}, {10014, 163, 50536}, {10007, 146, 50516}, {10007, 146, 50515}, {10007, 146, 50514}, {10014, 163, 50537}, {10007, 146, 50513}, {10029, 162, 50511}, {10028, 163, 50511}, {10027, 164, 50511}, {10025, 165, 50510}, {10025, 165, 50511}, {10009, 147, 50514}, {10028, 163, 50518}, {10029, 162, 50518}, {10014, 140, 50523}, {10014, 141, 50523}, {10024, 163, 50507}, {10016, 140, 50523}, {10019, 139, 50525}, {10024, 164, 50507}, {10018, 140, 50524}, {10024, 166, 50508}, {10018, 140, 50523}, {10019, 139, 50526}, {10019, 139, 50527}, {10020, 163, 50519}, {10031, 163, 50519}, {10021, 165, 50522}, {10036, 161, 50518}, {10031, 163, 50520}, {10022, 163, 50519}, {10026, 163, 50519}, {10026, 163, 50518}, {10020, 161, 50523}, {10038, 161, 50515}, {10012, 141, 50523}, {10020, 161, 50524}, {10038, 161, 50513}, {10036, 161, 50510}, {10038, 161, 50511}, {10019, 139, 50530}, {10038, 161, 50512}, {10035, 163, 50518}, {10009, 152, 50510}, {10009, 152, 50512}, {10009, 152, 50511}, {10009, 152, 50513}, {10033, 163, 50510}, {10031, 163, 50510}, {10021, 154, 50513}, {10021, 154, 50514}, {10007, 144, 50522}, {10007, 144, 50521}, {10025, 159, 50525}, {10025, 159, 50526}, {10007, 144, 50520}, {10018, 165, 50522}, {10019, 158, 50524}, {10018, 157, 50509}, {10022, 155, 50519}, {10025, 162, 50519}, {10037, 160, 50518}, {10034, 164, 50518}, {10032, 164, 50519}, {10034, 164, 50519}, {10022, 155, 50523}, {10023, 162, 50519}, {10022, 155, 50522}, {10022, 155, 50521}, {10020, 166, 50522}, {10037, 160, 50519}, {10022, 155, 50520}, {10037, 160, 50510}, {10011, 142, 50523}, {10018, 157, 50510}, {10015, 161, 50536}, {10015, 161, 50535}, {10019, 153, 50511}, {10018, 162, 50532}, {10019, 153, 50512}, {10021, 159, 50530}, {10018, 164, 50534}, {10019, 164, 50539}, {10018, 164, 50535}, {10017, 164, 50531}, {10017, 162, 50533}, {10018, 164, 50533}, {10016, 164, 50538}, {10019, 155, 50510}, {10017, 164, 50539}, {10013, 153, 50510}, {10019, 164, 50534}, {10018, 164, 50539}, {10019, 164, 50535}, {10011, 153, 50510}, {10012, 153, 50510}, {10013, 164, 50529}, {10013, 164, 50528}, {10016, 155, 50508}, {10016, 157, 50507}, {10014, 164, 50529}, {10014, 164, 50528}, {10016, 166, 50523}, {10019, 162, 50520}, {10017, 166, 50522}, {10018, 159, 50525}, {10019, 159, 50526}, {10019, 160, 50526}, {10019, 159, 50525}, {10019, 159, 50524}, {10019, 164, 50520}, {10019, 166, 50522}, {10019, 160, 50524}, {10015, 164, 50538}, {10014, 164, 50537}, {10015, 164, 50537}, {10014, 162, 50536}, {10017, 164, 50530}, {10015, 162, 50536}, {10016, 164, 50530}, {10016, 164, 50531}, {10020, 160, 50527}, {10020, 160, 50524}, {10018, 162, 50518}, {10019, 162, 50519}, {10018, 162, 50519}, {10019, 162, 50518}, {10021, 160, 50529}, {10024, 160, 50523}, {10020, 164, 50535}, {10025, 160, 50526}, {10024, 160, 50522}, {10020, 164, 50536}, {10023, 160, 50523}, {10010, 148, 50515}, {10024, 160, 50526}, {10021, 160, 50530}, {10011, 148, 50515}, {10020, 153, 50511}, {10020, 160, 50530}, {10016, 166, 50522}, {10020, 153, 50512}, {10025, 160, 50527}, {10015, 166, 50523}, {10010, 151, 50518}, {10010, 151, 50519}, {10013, 166, 50523}, {10009, 143, 50522}, {10010, 151, 50514}, {10025, 157, 50523}, {10010, 151, 50515}, {10025, 157, 50524}, {10013, 166, 50524}, {10017, 155, 50509}, {10011, 151, 50518}, {10022, 153, 50515}, {10011, 151, 50517}, {10022, 153, 50516}, {10022, 153, 50517}, {10011, 151, 50519}, {10020, 139, 50527}, {10021, 164, 50522}, {10020, 164, 50522}, {10019, 138, 50531}, {10019, 138, 50530}, {10020, 139, 50528}, {10020, 139, 50529}, {10026, 164, 50512}, {10008, 146, 50513}, {10026, 165, 50511}, {10008, 146, 50514}, {10025, 166, 50510}, {10029, 163, 50511}, {10027, 163, 50511}, {10008, 146, 50515}, {10027, 163, 50518}, {10028, 162, 50518}, {10023, 164, 50510}, {10029, 163, 50519}, {10020, 139, 50530}, {10013, 141, 50523}, {10023, 163, 50506}, {10023, 164, 50508}, {10023, 163, 50507}, {10017, 140, 50523}, {10015, 140, 50523}, {10023, 164, 50509}, {10019, 140, 50524}, {10019, 140, 50525}, {10025, 166, 50508}, {10025, 166, 50509}, {10024, 165, 50508}, {10024, 165, 50507}, {10007, 145, 50520}, {10008, 144, 50521}, {10009, 142, 50522}, {10021, 163, 50519}, {10030, 163, 50519}, {10032, 163, 50519}, {10034, 163, 50518}, {10021, 163, 50522}, {10023, 163, 50519}, {10025, 163, 50519}, {10037, 161, 50517}, {10037, 161, 50516}, {10021, 161, 50523}, {10020, 165, 50522}, {10032, 163, 50520}, {10020, 165, 50521}, {10007, 145, 50519}, {10007, 145, 50517}, {10007, 145, 50518}, {10037, 161, 50510}, {10011, 141, 50523}, {10007, 145, 50516}, {10026, 165, 50512}, {10018, 136, 50534}, {10018, 136, 50533}, {10018, 136, 50532}, {10034, 163, 50510}, {10009, 151, 50513}, {10009, 151, 50514}, {10022, 154, 50514}, {10011, 149, 50516}, {10011, 149, 50517}, {10032, 163, 50510}, {10020, 154, 50513}, {10020, 154, 50511}, {10017, 157, 50508}, {10017, 165, 50522}, {10021, 166, 50522}, {10019, 165, 50521}, {10019, 165, 50520}, {10020, 162, 50519}, {10023, 155, 50523}, {10023, 155, 50518}, {10023, 155, 50519}, {10038, 160, 50515}, {10038, 160, 50514}, {10019, 157, 50510}, {10033, 164, 50519}, {10010, 142, 50522}, {10016, 161, 50534}, {10038, 160, 50511}, {10018, 136, 50537}, {10038, 160, 50510}, {10018, 136, 50536}, {10018, 136, 50535}, {10016, 161, 50535}, {10017, 165, 50531}, {10036, 160, 50518}, {10024, 162, 50519}, {10010, 142, 50523}};



    private static void init() {
        Lamps1and2Path.clear();
        Lamp3Path.clear();
        WindChargePath.clear();

        for (int[] c : Lamps1and2Coords) Lamps1and2Path.add(new BlockPos(c[0], c[1], c[2]));
        for (int[] c : Lamp3Coords) Lamp3Path.add(new BlockPos(c[0], c[1], c[2]));
        for (int[] c : WindChargeCoords) WindChargePath.add(new BlockPos(c[0], c[1], c[2]));
    }

    public static void registerTrailListener() {
        init();
        ClientTickEvents.END_CLIENT_TICK.register(client -> {
            if (client.world == null) return;

            switch (currentMode) {
                case LAMPS1AND2 -> Lamps1and2Path.forEach(pos -> spawnParticle(pos, 0xFF0000));
                case LAMP3 -> Lamp3Path.forEach(pos -> spawnParticle(pos, 0x00FF00));
                case WINDCHARGE -> WindChargePath.forEach(pos -> spawnParticle(pos, 0x0000FF));
                case OFF -> {
                }
            }
        });
    }

    private static void spawnParticle(BlockPos pos, int rgbColor) {
        Vec3d vec = Vec3d.ofCenter(pos);
        DustParticleEffect particle = new DustParticleEffect(rgbColor, 1.0f);

        MinecraftClient.getInstance().world.addParticle(particle, vec.x, vec.y + 0.5, vec.z, 0, 0.02, 0);
    }

    public static void cycleMode() {
        currentMode = currentMode.next();
    }

    public static TrailMode getCurrentMode() {
        return currentMode;
    }
}
